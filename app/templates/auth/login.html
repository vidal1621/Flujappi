{% extends 'layout/templateAuth.html' %}
{% block content %}
<div class="nk-content ">
    <div class="nk-split nk-split-page nk-split-md">
        <div class="nk-split-content nk-block-area nk-block-area-column nk-auth-container bg-white">
            <div class="absolute-top-right d-lg-none p-3 p-sm-5">
                <a href="#" class="toggle btn-white btn btn-icon btn-light" data-target="athPromo"><em class="icon ni ni-info"></em></a>
            </div>
            <div class="nk-block nk-block-middle nk-auth-body">
                <div class="brand-logo pb-5" style="text-align: center;">
                    <a href="#" class="logo-link">
                        <img src="/static/assets/images/logo/flujappi-2.png" style="height: 100px; width: 100px;">
                    </a>
                </div>
                <div class="nk-block-head">
                    <div class="nk-block-head-content">
                        <h5 class="nk-block-title">Iniciar Sesión</h5>
                        <div class="nk-block-des">
                            <p>Acceder a Flujappi usando email y contraseña</p>
                        </div>
                    </div>
                </div><!-- .nk-block-head -->
                <form method="post" id="login">
                    <div class="form-group">
                        <div class="form-label-group">
                            <label class="form-label" for="default-01">Email</label>
                            <a class="link link-primary link-sm" data-trigger="hover" data-toggle="popover" title="Olvido Email" data-content="Contactese con nosotros!">¿Necesita Ayuda?</a>
                        </div>
                        <input type="text" class="form-control form-control-lg" id="email" name="email" placeholder="Ingrese con su email">
                    </div><!-- .foem-group -->
                    <div class="form-group">
                        <div class="form-label-group">
                            <label class="form-label" for="password">Contraseña</label>
                            <a class="link link-primary link-sm" tabindex="-1" href="/olvidoPass">¿Olvidaste tu contraseña?</a>
                        </div>
                        <div class="form-control-wrap">
                            <a tabindex="-1" href="#" class="form-icon form-icon-right passcode-switch" data-target="password">
                                <em class="passcode-icon icon-show icon ni ni-eye"></em>
                                <em class="passcode-icon icon-hide icon ni ni-eye-off"></em>
                            </a>
                            <input type="password" class="form-control form-control-lg" id="password" name="password" placeholder="Ingrese su contraseña">
                        </div>
                    </div><!-- .foem-group -->
                    <div class="form-group">
                        <div class="custom-control custom-control-xs custom-checkbox">
                            <input type="checkbox" class="custom-control-input" id="checkbox">
                            <label class="custom-control-label" for="checkbox">Recordar Usuario</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-lg btn-primary btn-block">Iniciar Sesión</button>
                    </div>
                    {#<div class="form-group" style="text-align: center">
                        <button class="btn btn-danger">
                            <em class="icon ni ni-google" data-toggle="tooltip" data-placement="left" title="Iniciar sesión con Google"></em>
                        </button>
                        <button class="btn btn-info">
                            <em class="icon ni ni-linkedin-round" data-toggle="tooltip" data-placement="left" title="Iniciar sesión con Linkedin"></em>
                        </button>
                    </div>#}
                </form><!-- form -->
                <div class="form-note-s2 pt-4"> ¿Nuevo en la plataforma? <a href="/signup">Crear una cuenta</a>
                </div>
            </div><!-- .nk-block -->
            <div class="nk-block nk-auth-footer">
                <div class="nk-block-between">

                </div>
                <div class="mt-3">
                    <p>&copy; 2021 <a href="/">Flujappi</a>. Todos los derechos reservados.</p>
                </div>
            </div><!-- .nk-block -->
        </div><!-- .nk-split-content -->
        <div class="nk-split-content nk-split-stretch bg-lighter d-flex toggle-break-lg toggle-slide toggle-slide-right" data-content="athPromo" data-toggle-screen="lg" data-toggle-overlay="true" style="background-image: url('/static/images/bg-login-img.jpg')">
            <div class="slider-wrap w-100 w-max-550px p-3 p-sm-5 m-auto">
                <div class="slider-init" data-slick='{"dots":true, "arrows":false}'>
                    <div class="slider-item">
                        <div class="nk-feature nk-feature-center">
                            <div class="nk-feature-img">
                                <img class="round" src="/static/images/slides/infoFinanciera.jpg" srcset="/static/images/slides/promo-a2x.png 2x" alt="">
                            </div>
                            <div class="nk-feature-content py-4 p-sm-5">
                                <h4>Información Financiera</h4>
                                <p>Información contable al alcance de tus manos</p>
                            </div>
                        </div>
                    </div><!-- .slider-item -->
                    <div class="slider-item">
                        <div class="nk-feature nk-feature-center">
                            <div class="nk-feature-img">
                                <img class="round" src="/static/images/slides/sii.png" srcset="/static/images/slides/promo-b2x.png 2x" alt="">
                            </div>
                            <div class="nk-feature-content py-4 p-sm-5">
                                <h4>Conexión con SII</h4>
                                <p>Conexión directa con el Servicio de Puestos Internos</p>
                            </div>
                        </div>
                    </div><!-- .slider-item -->
                    <div class="slider-item">
                        <div class="nk-feature nk-feature-center">
                            <div class="nk-feature-img">
                                <div class="nk-block block-partners">
                                    <div class="row">
                                        <img class="round" src="/static/images/bancos/santander.png" style="width:200px;height: 40px">
                                        <img class="round" src="/static/images/bancos/bciNormal.png" style="width:200px">
                                        <img class="round" src="/static/images/bancos/bancoChileAz.png" style="width:200px">
                                        <img class="round" src="/static/images/bancos/bancoEstado.png" style="width:200px">
                                    </div>
                                </div>
                            </div>
                            <div class="nk-feature-content py-4 p-sm-5">
                                <h4>Conexión con tu Banco</h4>
                                <p>Acceso a la cartola de tus bancos y como influyen en tu negocio</p>
                            </div>
                        </div>
                    </div><!-- .slider-item -->
                </div><!-- .slider-init -->
                <div class="slider-dots"></div>
                <div class="slider-arrows"></div>
            </div><!-- .slider-wrap -->
        </div><!-- .nk-split-content -->
    </div><!-- .nk-split -->
</div>
<script src="/static/assets/js/jquery.cookie.js"></script>
<script>
$("#login").submit(function () {
    if ($('#checkbox').is(':checked')) {
        var email = $('#email').val();
        var password = $('#password').val();

        // set cookies to expire in 14 days
        $.cookie('email', email, {expires: 14});
        $.cookie('password', password, {expires: 14});
        $.cookie('checkbox', true, {expires: 14});
    } else {
        // reset cookies
        $.cookie('email', null);
        $.cookie('password', null);
        $.cookie('checkbox', null);
    }
});
var checkbox = $.cookie('checkbox')
if (checkbox == 'true') {
    var email = $.cookie('email');
    var password = $.cookie('password');
    // autofill the fields
    $('#email').attr("value", email);
    $('#password').attr("value", password);
}
</script>
{% with messages = get_flashed_messages() %}
    {% if messages %}
        <script>
            var mensaje = '{{ messages[0] }}';
            switch (mensaje) {
                case 'error':
                    Swal.fire("Error", "No se encontró el usuario", "error");
                    break;
                case 'correcto':
                    Swal.fire("Correcto", "Ha finalizado la sesión", "success");
                    break;
                case 'restablecer password':
                    Swal.fire("Correcto", "Se envió el email para restablecer la contraseña", "success");
                    break;
                case 'error usuario no existe token no valido':
                    Swal.fire("Error", "Usuario no existe token no valido", "error");
                    break;
                case 'contrasena incorrecta':
                    Swal.fire("Error", "La contraseña no es válida", "error");
                    break;
                case 'expirada':
                    Swal.fire("Alerta", "La sesión expiró", "warning");
                    break;
                case 'sinpagos':
                    Swal.fire("Alerta", "Debe generar el pago del servicio", "warning");
                    break;
                case 'ok':
                    Swal.fire("Ok", "Se enviarón sus datos para suscribirse correctamente", "success");
                    break;
                case 'exitoso':
                    Swal.fire("Correcto", "Se ha generado el pago de su servicio correctamente", "success");
                    break;
                default:
                    console.log(mensaje);
                    break;
            }
            console.log(mensaje);
        </script>
    {% endif %}
{% endwith %}
{% endblock %}